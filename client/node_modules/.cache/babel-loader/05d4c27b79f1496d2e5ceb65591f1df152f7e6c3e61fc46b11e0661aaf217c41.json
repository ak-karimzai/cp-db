{"ast":null,"code":"import { store } from \"./store\";\nlet Security = {\n  saveToken: token => {\n    let date = new Date();\n    let expDays = 30;\n    date.setTime(date.getTime() + expDays * 24 * 60 * 60 * 1000);\n    const expires = \"expires=\" + date.toUTCString();\n    document.cookie = \"token=\" + JSON.stringify(token) + \";\" + expires + \";Path=/\" + \";\" + \"SameSite=Strict;\" + \"Secure\";\n  },\n  setTokenNull: () => {\n    document.cookie = \"token=\" + \";\" + \"Expires=Thu, 01 Jan 1970 00:00:01 GMT\" + \";Path=/\" + \";\" + \"SameSite=Strict;\" + \"Secure\";\n  },\n  requestOptions: (payload, method = \"POST\") => {\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", \"Bearer \" + store.token);\n    return {\n      method: method,\n      body: JSON.stringify(payload),\n      headers: headers\n    };\n  },\n  requestOptionsWithoutBody: (method = \"GET\") => {\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", \"Bearer \" + store.token);\n    return {\n      method: method,\n      headers: headers\n    };\n  },\n  isAdmin: () => {\n    fetch(`${process.env.VUE_APP_SERVER_API}/auth/check?admin=true?token=${store.token}`, this.requestOptionsWithoutBody()).then(response => response.json()).then(response => {\n      if (response.error) {\n        this.$emit(\"error\", response.error.message);\n      }\n    }).catch(err => this.$emit(\"error\", err));\n  }\n};\nexport default Security;","map":{"version":3,"names":["store","Security","saveToken","token","date","Date","expDays","setTime","getTime","expires","toUTCString","document","cookie","JSON","stringify","setTokenNull","requestOptions","payload","method","headers","Headers","append","body","requestOptionsWithoutBody","isAdmin","fetch","process","env","VUE_APP_SERVER_API","then","response","json","error","$emit","message","catch","err"],"sources":["/home/khalid/uni/6thsem/cp_db/new_code/client/src/components/security.js"],"sourcesContent":["import { store } from \"./store\";\n\nlet Security = {\n  saveToken: (token) => {\n    let date = new Date();\n    let expDays = 30;\n    date.setTime(date.getTime() + expDays * 24 * 60 * 60 * 1000);\n    const expires = \"expires=\" + date.toUTCString();\n    document.cookie =\n      \"token=\" +\n      JSON.stringify(token) +\n      \";\" +\n      expires +\n      \";Path=/\" +\n      \";\" +\n      \"SameSite=Strict;\" +\n      \"Secure\";\n  },\n  setTokenNull: () => {\n    document.cookie =\n      \"token=\" +\n      \";\" +\n      \"Expires=Thu, 01 Jan 1970 00:00:01 GMT\" +\n      \";Path=/\" +\n      \";\" +\n      \"SameSite=Strict;\" +\n      \"Secure\";\n  },\n  requestOptions: (payload, method = \"POST\") => {\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", \"Bearer \" + store.token);\n\n    return {\n      method: method,\n      body: JSON.stringify(payload),\n      headers: headers,\n    };\n  },\n  requestOptionsWithoutBody: (method = \"GET\") => {\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", \"Bearer \" + store.token);\n\n    return {\n      method: method,\n      headers: headers,\n    };\n  },\n  isAdmin: () => {\n    fetch(\n      `${process.env.VUE_APP_SERVER_API}/auth/check?admin=true?token=${store.token}`,\n      this.requestOptionsWithoutBody()\n    )\n      .then((response) => response.json())\n      .then((response) => {\n        if (response.error) {\n          this.$emit(\"error\", response.error.message);\n        }\n      })\n      .catch((err) => this.$emit(\"error\", err));\n  },\n};\n\nexport default Security;\n"],"mappings":"AAAA,SAASA,KAAK,QAAQ,SAAS;AAE/B,IAAIC,QAAQ,GAAG;EACbC,SAAS,EAAGC,KAAK,IAAK;IACpB,IAAIC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAAC;IACrB,IAAIC,OAAO,GAAG,EAAE;IAChBF,IAAI,CAACG,OAAO,CAACH,IAAI,CAACI,OAAO,CAAC,CAAC,GAAGF,OAAO,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;IAC5D,MAAMG,OAAO,GAAG,UAAU,GAAGL,IAAI,CAACM,WAAW,CAAC,CAAC;IAC/CC,QAAQ,CAACC,MAAM,GACb,QAAQ,GACRC,IAAI,CAACC,SAAS,CAACX,KAAK,CAAC,GACrB,GAAG,GACHM,OAAO,GACP,SAAS,GACT,GAAG,GACH,kBAAkB,GAClB,QAAQ;EACZ,CAAC;EACDM,YAAY,EAAEA,CAAA,KAAM;IAClBJ,QAAQ,CAACC,MAAM,GACb,QAAQ,GACR,GAAG,GACH,uCAAuC,GACvC,SAAS,GACT,GAAG,GACH,kBAAkB,GAClB,QAAQ;EACZ,CAAC;EACDI,cAAc,EAAEA,CAACC,OAAO,EAAEC,MAAM,GAAG,MAAM,KAAK;IAC5C,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;IAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAClDF,OAAO,CAACE,MAAM,CAAC,eAAe,EAAE,SAAS,GAAGrB,KAAK,CAACG,KAAK,CAAC;IAExD,OAAO;MACLe,MAAM,EAAEA,MAAM;MACdI,IAAI,EAAET,IAAI,CAACC,SAAS,CAACG,OAAO,CAAC;MAC7BE,OAAO,EAAEA;IACX,CAAC;EACH,CAAC;EACDI,yBAAyB,EAAEA,CAACL,MAAM,GAAG,KAAK,KAAK;IAC7C,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;IAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAClDF,OAAO,CAACE,MAAM,CAAC,eAAe,EAAE,SAAS,GAAGrB,KAAK,CAACG,KAAK,CAAC;IAExD,OAAO;MACLe,MAAM,EAAEA,MAAM;MACdC,OAAO,EAAEA;IACX,CAAC;EACH,CAAC;EACDK,OAAO,EAAEA,CAAA,KAAM;IACbC,KAAK,CACF,GAAEC,OAAO,CAACC,GAAG,CAACC,kBAAmB,gCAA+B5B,KAAK,CAACG,KAAM,EAAC,EAC9E,IAAI,CAACoB,yBAAyB,CAAC,CACjC,CAAC,CACEM,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEC,QAAQ,IAAK;MAClB,IAAIA,QAAQ,CAACE,KAAK,EAAE;QAClB,IAAI,CAACC,KAAK,CAAC,OAAO,EAAEH,QAAQ,CAACE,KAAK,CAACE,OAAO,CAAC;MAC7C;IACF,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,IAAK,IAAI,CAACH,KAAK,CAAC,OAAO,EAAEG,GAAG,CAAC,CAAC;EAC7C;AACF,CAAC;AAED,eAAenC,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}